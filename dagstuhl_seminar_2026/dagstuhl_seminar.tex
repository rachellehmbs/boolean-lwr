\documentclass[aspectratio=169,rgb,dvipsnames]{beamer}
\usetheme{anssi}

\usepackage[T1]{fontenc}
\usepackage{setspace}
\usepackage{tabularx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{calrsfs}
%\usepackage[dvipsnames]{xcolor}
\usepackage{tikz}
\usepackage{ragged2e}
\usepackage{mathtools}
\usepackage{wrapfig}
\usepackage[ruled,vlined,french]{algorithm2e}
\usepackage{array}
\usepackage[absolute,overlay]{textpos}
\usepackage{algorithmic}
\usepackage[most]{tcolorbox}
\usepackage{graphicx}
\usepackage{ulem}
\usepackage{multirow}
%\usepackage{enumitem}
\usepackage{pifont}
\usepackage{fontawesome}
%\usepackage{fourier} %warning symbol
\usepackage{bm}
\usepackage{changepage}
\usepackage{cancel}
\usepackage{ marvosym }
\usepackage{jigsaw}
\usepackage{changepage}
\usepackage{rotating}
\usepackage{stmaryrd}
\usepackage{makecell}

%TikZ
\renewcommand{\arraystretch}{1}
\usetikzlibrary{patterns}
\usetikzlibrary{keccak}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{arrows}
\usetikzlibrary{crypto.symbols}
\usetikzlibrary{backgrounds}
\usetikzlibrary{shapes.geometric, shapes.gates.logic.US}
\usetikzlibrary{fit,calc,positioning,automata}
\usetikzlibrary {decorations.pathmorphing, decorations.pathreplacing, decorations.shapes}

\usepackage{standalone} % Necessary to skip headers of {standalone} documents
\usepackage{tikzscale} % To use \includegraphics with TikZ code

\usetikzlibrary{calc}
\usetikzlibrary{decorations.pathmorphing}
% Comment the line below for faster compilation and misaligned figures
\usetikzlibrary{bbox}
\usetikzlibrary{fit}
\tikzstyle{sponge}=[rectangle, rounded corners=.25cm, minimum width=.5cm, minimum height=3cm, draw]
\tikzstyle{ipoint}=[shape=circle,inner sep=0pt,minimum size=3pt,outer sep=1pt]
\tikzstyle{point}=[ipoint,fill]
\tikzstyle{xpoint}=[ipoint,draw]
\tikzstyle{cpoint}=[point,outer sep=0pt]

\colorlet{pcolor}{green!60!black}
\colorlet{mcolor}{pcolor!20!white}
\colorlet{bcolor}{mcolor!50!pcolor}


%\usepackage{colortbl}
\newcommand{\rouge}{\textcolor{rouge3}}
\newcommand{\ver}{\textcolor{vert3}}
\newcommand{\bleu}{\textcolor{NavyBlue}}

%\newcommand{\correcttilde}[1]{\text{\~{}}{#1}}

\input{macros_soutenance.tex}
  
%\makeatother
\setbeamertemplate{footline}
{
  \leavevmode%
  \hbox{%
  \begin{beamercolorbox}[wd=.2\paperwidth,ht=2.25ex,dp=1ex,center]{author in head/foot}%
    \usebeamerfont{author in head/foot}\insertshortauthor
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.6\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
    \usebeamerfont{title in head/foot}\insertshorttitle
  \end{beamercolorbox}%
  \begin{beamercolorbox}[wd=.2\paperwidth,ht=2.25ex,dp=1ex,center]{date in head/foot}%
    \insertframenumber{} / \inserttotalframenumber\hspace*{1ex}
  \end{beamercolorbox}}%
  \vskip0pt%
}

%\makeatletter
\setbeamertemplate{navigation symbols}{}

\title{Boolean Modeling and Analysis of Learning With Rounding}
\author[]{\normalsize Jules Baudrin, Rachelle Heim Boissier, François-Xavier Standaert}
\institute{\small Dagstuhl Seminar}
\centering
\date{Feb. 2026}

\begin{document}
\maketitle
\AtBeginSection[]
{
 \begin{frame}<beamer>
 \frametitle{Outline}
 \tableofcontents[currentsection]
 \end{frame}
}



%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%


\section{Introduction: motivation and setting}

\begin{frame}{Hard learning problems}
\small 

\begin{exampleblock}{}
Learning With Error (LWE), Learning With Rounding (LWR), Learning Parity with Noise (LPN) \\
\end{exampleblock}
and their ring/module variants.

\medskip
\flushleft
Central importance in \ver{post-quantum cryptography}
\begin{itemize}
\item Encryption, Key encapsulation mechanisms: CRYSTALS-Kyber, Saber 
\smallskip
\item Signatures: CRYSTALS-Dilithium, BLISS
\end{itemize}


\medskip

and in \ver{symmetric cryptography}:
\begin{itemize}
\item Essentially to build (key homomorphic) PRFs for a variety of applications.
\smallskip
\item E.g. distributed PRFs, proxy re-encryption, updatable encryption (Boneh et al., 2013)
\end {itemize}

\bigskip
\vfill

\end{frame}

%%%%%%
%%%%%%
%%%%%%

\begin{frame}{Learning With Errors}
\small

In a nutshell: solving a \rouge{noisy} \bleu{linear system} over a ring. 

\smallskip

\begin{exampleblock}{Search Learning With Errors (Regev 05)}

{Parameters:} $q \in \NN$, $n \in \NN^{*}$, \bleu{small (Gaussian) distribution $\chi$} over $\ZZ_q$,  \rouge{secret $\vecx$} $\drawfrom \ZZ_{q}^n$ 

\medskip

{Given} samples from the distribution 
\begin{align*}
\mathcal{D}^{\mathsf{LWE}} = \{ \ (\veca, \langle \veca , \rouge{\vecx} \rangle + e), \ \veca \drawfrom \ZZ_{q}^n, \ e \leftarrow \bleu{\chi} \ \}
\end{align*}

\smallskip

{Find} \rouge{$\vecx$}. 
 %drawn uniformly drawn in $\ZZ_{q}^n$ from 

\end{exampleblock}

\medskip

\pause
\ver{Decision LWE}: distinguish from $\mathcal{D}_0 = \{(\veca, r)\mid \veca \drawfrom \ZZ_{q}^n, r \drawfrom  \ZZ_{q}\} $

\pause

\medskip
\begin{itemize}
\item Security level is determined by \rouge{$n$}, \rouge{$q$}, and \rouge{standard deviation $\sigma$} of $\chi$. 
\item Drawback: LWE cannot be used to build \bleu{deterministic primitives} such as PRFs. 
\end{itemize}

\vfill

\end{frame}

%%%%%%
%%%%%%
%%%%%%

\begin{frame}{Learning with Rounding}
 
 \small
 {\it `A way of partially `\rouge{derandomizing}' the LWE problem, i.e. generating errors efficiently and \ver{deterministically}'.} 
 
 \vspace{-4mm}
 \flushright
{\footnotesize Banerjee, Peikert, Rosen, EC' 2012.}

\smallskip

\begin{exampleblock}{Search Learning With Rounding}

{Parameters:} $q \in \NN$, $p,n \in \NN^{*}$, $p < q$, \bleu{rounding function} $\bleu{\round{\cdot}_{p}} : \ZZ_{q} \rightarrow \ZZ_{p} $, \rouge{secret $\vecx$} $\drawfrom \ZZ_{q}^n$

\medskip

{Given} samples from the distribution 
\begin{align*}
\mathcal{D}^{\mathsf{LWR}} = \{ \ (\veca, \round{\langle \veca , \rouge{\vecx} \rangle}_p ), \ \veca \drawfrom \ZZ_{q}^n \ \}
\end{align*}

\smallskip

{Find} \rouge{$\vecx$}. 
 %drawn uniformly drawn in $\ZZ_{q}^n$ from 

\end{exampleblock}

%\flushleft

%\textbf{Today:} PQ cryptography (e.g. Saber [B+18]), symmetric cryptography (PRFs indeed). 

\vfill 
\end{frame}

%%%%%%
%%%%%%
%%%%%%

\begin{frame}{Power-of-two LWR}
 \small 
 
 %\flushleft
 %\textbf{Today:} Many use-cases rely on LWR with a power-of-two modulus.
 
 \only<1>{
\begin{exampleblock}{Search Learning With Rounding}

{Parameters:} $q \in \NN$, $p,n \in \NN^{*}$, $p < q$, \bleu{rounding function} $\bleu{\round{\cdot}_{p}} : \ZZ_{q} \rightarrow \ZZ_{p} $, \rouge{secret $\vecx$} $\drawfrom \ZZ_{q}^n$

\medskip

{Given} samples from the distribution 
\begin{align*}
\mathcal{D}^{\mathsf{LWR}} = \{ \ (\veca, s_{\veca} = \round{\langle \veca , \rouge{\vecx} \rangle}_p ), \ \veca \drawfrom \ZZ_{q}^n \ \}
\end{align*}

\smallskip

{Find} \rouge{$\vecx$}. 
 %drawn uniformly drawn in $\ZZ_{q}^n$ from 

\end{exampleblock}
}

 \only<2->{
\begin{exampleblock}{Search Learning With Rounding}

{Parameters:} $q \in \NN$, $p,n \in \NN^{*}$, $p < q$, \bleu{rounding function} $\bleu{\round{\cdot}_{2^p}} : \ZZ_{2^q} \rightarrow \ZZ_{2^p} $, \rouge{secret $\vecx$} $\drawfrom \ZZ_{2^q}^n$

\medskip

{Given} samples from the distribution 
\begin{align*}
\mathcal{D}^{\mathsf{LWR}} = \{ \ (\veca, s_{\veca} = \round{\langle \veca , \rouge{\vecx} \rangle}_p ), \ \veca \drawfrom \ZZ_{2^q}^n \ \}
\end{align*}

\smallskip

{Find} \rouge{$\vecx$}. 
 %drawn uniformly drawn in $\ZZ_{q}^n$ from 

\end{exampleblock}
}

\flushleft
\pause 
\pause

In this case: 

\begin{itemize}
\item the \bleu{$y \mapsto \round{y}_{2^p}$} removes the \rouge{$q-p$} LSBs.  
\item Security level is determined by \rouge{$n$}, \rouge{$q$} and \rouge{$q-p$}: noise $\sim Uniform[-2^{q-p},0)$ 
\end{itemize}
 \hfill e.g. LightSaber: $n = 512, q-p = 3$, dPRF LaKey $n = 256, q-p = 4$. 
 
\pause
%
%\medskip
%\textbf{Why is this case interesting?} We can use \ver{symmetric-key} techniques to analyse it.


\end{frame}


%%%%%%
%%%%%%
%%%%%%

\begin{frame}{Hardness}

\small
\flushleft
\vspace{-4mm}
\textbf{Theory}
\begin{itemize}
\item \rouge{LWE:} Solid theoretical foundations (e.g. Brakerski et al. 13).
\item \ver{LWR} is \bleu{as hard as} LWE (asymptotic reduction, underlying assumptions). 

\end{itemize}

\bigskip

\textbf{Practice}
\begin{itemize}
\item Parameter selection driven by \rouge{best known attacks} (Lattice estimator, Albrecht et al.)
\end{itemize}

 \begin{exampleblock}{}

 {\it `The hardness of (ring or module) LWR can be analyzed as an LWE problem, since there is no known attacks that make use of the additional structure offered by these variants'.} 
 
  \flushright
\vspace{-3mm}
{\footnotesize SABER specifications}
  \end{exampleblock}
  
\smallskip
\centering
{\bf Open question:} what does a deterministic error do to (practical) security?

\vfill
\end{frame}


%%%%%%
%%%%%%
%%%%%%


\begin{frame}{Linearisation attack by Arora \& Ge (2011)}

\small
\vspace{-2mm}
\begin{itemize}
\item Low noise, large number of samples (not SABER). 
\end{itemize}

\vspace{-1mm}
\begin{exampleblock}{}
\textbf{Parameters:} $n \in \NN^{*}$, Noise in set \bleu{$E$}.  

\smallskip
Any sample $(\ver{\veca}, s_{\ver{\veca}})$, yields the following equation over $\ZZ_{2^{q}}$ in the unknowns $\rouge{\vecx} = (\rouge{\vecx_{0}}, \ldots,\rouge{\vecx_{n-1}})$
\begin{align*}
\prod_{e \in \bleu{E}} \left(\sum_{i=0}^{n-1} \ver{\veca_{i}} \times \rouge{\vecx_{i}} - e - s_{\ver{\veca}}\right) = 0\,. 
\end{align*}
%\footnotesize
%\flushright
%A polynomial of degree \bleu{$T$} in \bleu{$n$} over $\ZZ_q$ has at most $\binom{n+T}{T}$ monomials. 
%\smallskip
%A polynomial of degree \bleu{$\card{E}$} has at most $\binom{n+\bleu{\card{E}}}{\bleu{\card{E}}}$ \textbf{monomials}. 

\textbf{Linearisation:} $\binom{n+\bleu{\card{E}}}{\bleu{\card{E}}}$ in data, $\binom{n+\bleu{\card{E}}}{\bleu{\card{E}}}^{\omega}$ in time, $\omega$ linear algebra constant.

% \footnotesize
% \flushright
\textbf{Gröbner-based solving?} Some asymptotic results for prime or odd moduli \rouge{(not $2^q$)}.  

\end{exampleblock}

\small
\vspace{-1mm}
\begin{itemize}
\item \textbf{LWE}: Gaussian distribution: bounded noise for a well-chosen number of samples.
\item \textbf{LWR}: $\bleu{\card{E}} = 2^{q-p}$. 
\end{itemize}



\pause
\begin{alertblock}{}
Our main result: in the case of LWR, one can do better.
\end{alertblock}

\end{frame}

%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%

\section{A symmetric point of view}

\begin{frame}{A symmetric point of view}

$$\ZZ_{2^{q}} \quad \simeq \quad \set{0,1,2,\ldots, 2^{q}-1} \quad \simeq \quad  \bleu{\FF_{2}^{q}}$$ 
\pause
\medskip

\small
\flushleft
\begin{itemize}
  \item $n$ known values $\ver{\veca_{i}} \in \ZZ_{2^{q}}$ $\quad \simeq \quad $ $nq$ known \bleu{bits} $(\ver{\veca_{i,j}})_{\substack{0 \leq i \leq n-1\\ 0 \leq j \leq q-1}} \in \bleu{\FF_{2}^{nq}}$.
  \medskip
  \item  $n$ unknowns $\rouge{\vecx_{i}}$ in $\ZZ_{2^{q}}$ $\quad \simeq \quad$ $nq$ \bleu{binary} unknowns $(\rouge{\vecx_{i,j}})_{\substack{0 \leq i \leq n-1\\ 0 \leq j \leq q-1}} \in \bleu{\FF_{2}^{nq}}$.
\end{itemize}
\pause

\medskip

\begin{exampleblock}{}
\centering
The LWR function ``is'' a $(2nq, p)$-vectorial Boolean function:
\begin{align*}
  F :  \FF_{2}^{nq} \times \FF_{2}^{nq} \to \FF_{2}^{p}\quad\quad
  (\ver{\veca}, \rouge{\vecx}) \mapsto \left\lfloor \sum_{i=0}^{n-1} \ver{\veca_{i}} \times \rouge{\vecx_{i}}\right\rfloor_{2^p} 
\end{align*}
\end{exampleblock}

% \centering
% \smallskip
% Symmetric crypto $\heartsuit$ Boolean functions

\flushleft
The \textbf{LWR problem} can be studied in a ``symmetric'' manner ($\simeq$ weak-PRF).

\end{frame}


\begin{frame}{A strange (but handy) notation}

\small

% \begin{itemize}
% \item We deal with 2nq variables $\ver{\veca_{0, 0}}, \ldots, \ver{\veca_{0,q-1}}, \ldots, \ver{\veca_{n-1, 0}}, \ldots, \ver{\veca_{n-1,q-1}},\rouge{\vecx_{0, 0}}, \ldots, \rouge{\vecx_{0,q-1}}, \ldots, \rouge{\vecx_{n-1, 0}}, \ldots, \rouge{\vecx_{n-1,q-1}}$. 
% \end{itemize}

% \flushleft

\begin{exampleblock}{}
\textbf{The ``usual'' notation.} Let $y = (y_{0}, \ldots, y_{q-1}), m = (m_{0}, \ldots, m_{q-1}) \in \FF_2^s$: %Then $y^{m}$ stands for:
$$y^m \coloneq \prod_{i = 0}^{q-1} y_{i}^{m_{i}}\,.$$

\pause
\textbf{The ``not-so usual'' one.} For an \bleu{integer} $\tilde{m}$ of size $q$, $\tilde{m} = \sum_{i=0}^{q-1}\tilde{m}_{i}2^{i}$:% $y^{\tilde{m}}$ stands for:
$$y^{\tilde{m}} \coloneq \prod_{i = 0}^{q-1} y_{i}^{\tilde{m}_{i}}\,.$$

\pause
If $u_{0}, \ldots, u_{n-1}, v_{0}, \ldots, v_{n-1}$ are $q$-bit integers: %$\ver{\veca^{\vecu}}\ver{\vecx^{\vecv}}$ stands for:
$$ \ver{\veca^{\vecu}}\rouge{\vecx^{\vecv}} \coloneq \prod_{i} \prod_{j} \ver{a_{i, j}}^{u_{i, j}} \rouge{x_{i, j}}^{v_{i, j}}  $$
\end{exampleblock}

% \begin{itemize}
% \setlength{\itemsep}{2pt}
% \item[] Since $3 = (11)_2$, $x^{3}$ is the product of the two least significant bits of $x$, $x[0]x[1]$.
% \pause
% \item[] Since $4 = 2^2 = (100)_2$, $x^{4}$ is the third bit of $x$, $x[2]$.
% \pause
% \item[] Since $2^i = (10\ldots0)_2$, $x^{2^{i}}$ is the $i+1$th bit of $x$, $x[i]$.
% \end{itemize}


\end{frame}


\begin{frame}{An example}

\centering

 $$\text{Consider } \quad M = \ver{a_{0,0}a_{0, 1}a_{1, 0}a_{1, 1}a_{1, 2}}\rouge{x_{0, 0}x_{1, 0}x_{1, 1}}.$$

$$\text{We denote it by } M = \ver{a_{0}^{\mathtt{0b011}}a_{1}^{\mathtt{0b111}}}\rouge{x_{0}^{\mathtt{0b001}}x_{1}^{\mathtt{0b011}}} =  \ver{a^{(3, 7)}}\rouge{x^{(1, 3)}}.$$
\end{frame}




\begin{frame}{Algebraic Normal Form}

\begin{exampleblock}{}
\textbf{Algebraic Normal Form (ANF).} Any $f : \FF_2^s \rightarrow \FF_2$ admits a unique polynomial form:
\begin{align*}
\forall x \in \FF_2^s, \quad f(x) = \sum_{u \in \FF_2^s} \alpha_u(f) x^u  \,.
\end{align*}
\end{exampleblock}

\begin{exampleblock}{}
\textbf{Product of coordinates.} For any $F : \ZZ_{2^q} \to \ZZ_{2^q}$, and any $m = \sum_{i}m_i2^i$, we denote by:

$$F^m \coloneq \prod_i F_i^{m_i}.$$
\end{exampleblock}

% \begin{exampleblock}{}
% \textbf{ANF of modular addition.} \hfill [FSE:BraSem05]

% Let $F : \ZZ_{2^q} \times \ZZ_{2^q} \to \ZZ_{2^q} \quad (x_1, x_2) \mapsto x_1 + x_2$. Then:

% \bigskip
% $x_1^ux_2^v$ appears in $F^m = \prod_i F_i^{m_i} \quad $ if and only if $\quad u + v = m$. \hfill ($m, u, v \in \NN$)
% \end{exampleblock}


\begin{alertblock}{}
In the following, we study (product of) coordinates of the inner product:
\begin{align*}
F^{m,n} : (\veca, \vecx) \mapsto \left( \langle  \veca,  \vecx \rangle \right)^m \qquad \quad F^{m,n}_{\veca} : \vecx \mapsto \left( \langle  \veca,  \vecx \rangle \right)^m \,.
\end{align*}
\end{alertblock}

%This Boolean function returns the (product of) bit(s) of the LWR sample $\langle  \veca,  \vecx \rangle$.
% \pause
% \bigskip
% \textbf{Most important example:} 
% \begin{itemize}
% %\item \rouge{$m = 2^{0} = 1$}. $F^{1,n}$ returns the LSB of $\langle  \veca,  \vecx \rangle$. 
% %
% %The rounding function removes the $q-p$ LSBs: this bit \bleu{does not appear} in the LWR sample. 

% \item  \rouge{$m = 2^{q-p}$}. $F^{2^{q-p},n}$ returns the $q-p+1$th bit of  $\langle  \veca,  \vecx \rangle$.

% This corresponds to the \rouge{LSB of the LWR sample}. 
%\end{itemize}
\end{frame}




% \begin{frame}{Algebraic Normal Form}


% \footnotesize
% \flushleft

% \vspace{-4mm}
% \begin{exampleblock}{}
% The \rouge{Algebraic Normal Form} (ANF) of $f : \FF_2^s \rightarrow \FF_2$ is the \bleu{unique} multivariate polynomial 
% \begin{align*}
% \sum_{u \in \FF_{2}^s} \alpha_u(f) x^u \in \bleu{R} \qquad  \text{ s.t. } \qquad  \forall x \in \FF_2^s, \quad f(x) = \sum_{u \in \FF_2^m} \alpha_u(f) x^u  \,.
% \end{align*}

% \smallskip
% \textbf{Algebraic degree}. $$\ \deg(f) \coloneq \max_{u \in \FF_2^m | \alpha_u \neq 0}\hw(u). $$
% \end{exampleblock}

% \pause
% \begin{block}{}
% \textbf{Example.} $f : \FF_2^2 \rightarrow \FF_2$ defined by $f(00) = 0, f(01) = 1, f(10) = 0, f(11) = 0$. 
% \begin{align*}
% f = x[1]x[0] + x[0] = x^{3} + x^{1}  \qquad \qquad \text{degree 2.}
% \end{align*}
% \end{block}

% \pause
% %\smallskip
% %The coefficients and the evaluations of $f$ satisfy:
% %\begin{align*}
% %\forall x, u \in \FF_2^m, \quad \alpha_u(f) = \sum_{x \preceq u} f(x) \text{ and } f(x) = \sum_{u \preceq x} \alpha_u (f) \,. 
% %\end{align*}
% \smallskip
% Computing the ANF of a function is a necessary step for algebraic attacks. But it is \rouge{hard}: 
% \begin{itemize}
% \item costs \bleu{$s 2^{s-1}$}, requires to \ver{store the full LUT} of size \bleu{$2^s$}. 
% \item \rouge{\textbf{LWR:} $s = 2nq > 256$}. 
% \end{itemize}

% \end{frame}


%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{$\FF_2[\veca, \vecx]$ or $\FF_2[\veca][\vecx]$ ?}

\flushleft
\small
%\vspace{-3mm}
\begin{minipage}{0.5\textwidth}
$
\begin{aligned}
F^{m,n} : (\ZZ_{2^q})^n \times (\ZZ_{2^q})^n &\longrightarrow \quad \FF_2 \\ 
(\ver{\veca} , \rouge{\vecx}) \quad &\longmapsto \left( \langle  \ver{\veca},  \rouge{\vecx} \rangle \right)^m  \,. 
\end{aligned}
$
\end{minipage}
\begin{minipage}{0.09\textwidth}
$\quad$
\end{minipage}
\begin{minipage}{0.39\textwidth}
If $m = 2^{q-p}$ : coordinate of index $q-p$ (LSB of the sample). 
\end{minipage}

\pause
\smallskip
\begin{exampleblock}{}
$\FF_2[\veca, \vecx].$
$$ F^{m, n} = \sum_{\vecu, \vecv} \alpha_{\vecu, \vecv} \ver{\veca^{\vecu}}\rouge{\vecx^{\vecv}}, \quad\quad \alpha_{\vecu, \vecv} \in \FF_2.$$

\pause
$\FF_2[\veca][\vecx].$
$$ F^{m, n} = \sum_{\vecv} \underbrace{\left(\sum_{\vecu} \alpha_{\vecu,\vecv} \ver{\veca^{\vecu}}\right)}_{\alpha_{\vecv}}\rouge{\vecx^{\vecv}}, \quad\quad \alpha_{\vecv} \in \FF_2[\veca].$$
\end{exampleblock}




% \begin{block}{}
% \textbf{Example}. 
% \vspace{-7mm}
% \begin{align*}
% F^{2,2}(\ver{(a_0,a_1)}, \rouge{(x_0,x_1)}) &= \ver{a_0^1}\rouge{x_0^1} + \ver{a_1^1}\rouge{x_1^1} + \ver{a_0^1a_1^1}\rouge{x_0^1x_1^1} + \ver{a_0^1}\rouge{x_0^2} + \ver{a_0^2}\rouge{x_0^1}+\ver{a_1^1}\rouge{x_1^2} + \ver{a_1^2}\rouge{x_1^1} \\
% &= \ver{\veca^{(1,0)}} \rouge{\vecx^{(1,0)} } + \ver{\veca^{(0,1)} } \rouge{\vecx^{(0,1)} } +  \ver{\veca^{(1,1)}}\rouge{\vecx^{(1,1)}} + \ldots 
% \end{align*}

% $\alpha_{\ver{(1,0)}, \rouge{(1,0)}} = 1$, $\alpha_{\ver{(1,0)}, \rouge{(0,1)}} = 0$. 

% \pause
% \medskip
% \begin{itemize}
% \item If $\ver{\veca = (2,1)}$ we get the equation
% \end{itemize}
% \vspace{-2mm}
% \begin{align*}
%   x_1^1 + x_0^1 + x_1^2 = \vecx^{(0,1)} +  \vecx^{(1,0)} +  \vecx^{(0,2)}  = \text{ some bit of $s_{\ver{\veca}}$ } \,. 
% \end{align*}
% %\bleu{Linear} since all exponents have Hamming weight $1$. 

% \vspace{-2mm}
% \end{block}

% \pause
\vspace{-2mm}
\begin{alertblock}{}
  \begin{itemize}
    \item Cost of linearisation $\leq$  $\#\text{monomials}^{\omega} = \card{\exponents_{\vecx}(F^{m,n})}^{\omega}$ \hfill  with 
$
\exponents_{\vecx}(F^{m,n}) = \{\vecv \ | \alpha_{\vecv} \neq 0 \} \,.
$
\item Linearisation is possible only if the ANF of each $\alpha_{\vecv}$ is known \hfill (We'll get back to it\dots)
  \end{itemize}

\end{alertblock}

\end{frame}

%\begin{frame}{TBD}
%For each random $\ver{\veca}$, the function in $\{ F^{m,n}_{\ver{\veca}} \coloneq F^{m,n}({\ver{\veca}} , \cdot) \}$ is evaluated on the secret \rouge{$\vecx$} to yield $s_{\ver{\veca}}$. 
%\smallskip
%
%If we can compute the ANF of $F^{m,n}_{\ver{\veca}}$, we obtain an equation in the secret \rouge{$\vecx$}:
%\begin{align*}
%\sum_{\vecv \in (\FF_{2}^q)^n} \alpha_{\vecv}(F^{m,n}_{\ver{\veca}}) \ \rouge{\vecx}^{\vecv}  = (s_{\ver{\veca}})^{m/2^{q-p}} \,. 
%\end{align*}
%
%\pause
%\vspace{-2mm}
%\begin{alertblock}{}
%To do so, we study the ANF of $\bleu{F^{m,n}}$:
%\vspace{-1mm}
%\begin{align*}
%\sum_{(\vecu, \vecv) \in  \ZZ_{2^q}^n \times  \ZZ_{2^q}^n} \ \alpha_{\vecu,\vecv} \ \ver{\veca^{\vecu}} \rouge{\vecx^{\vecv}}  \onslide<5>{= \sum_{\vecv \in \ZZ_{2^q}^n} \ver{\alpha_{\vecv}} \ \rouge{\vecx^{\vecv}}} \qquad \text{ where } \alpha_{\vecu,\vecv} \in \FF_2, \, \onslide<5>{ \ver{\alpha_{\vecv}} = \sum_{\vecu \in  \ZZ_{2^q}^n} \alpha_{\vecu, \vecv} \ \ver{\veca^{\vecu}}} \,. 
%\end{align*} 
%
%\onslide<5>{and thus $\alpha_{\vecv}(F^{m,n})(\veca) = \alpha_{\vecv}(F^{m,n}_{\veca})$.}
%\end{alertblock}
%
%
%\end{frame}
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%

\section{Results}

\begin{frame}{Set of exponents of $F^{m, n}$}

\vspace{-2mm}
\begin{exampleblock}{}
  \textbf{Ordered integer partitions.}
Let $S^n_k = \{v \in \NN^n :  \sum_{i = 0}^{n-1} v_i = k\} $ be the set of $n$-long vectors that sum to $k$. %\hfill $\card{S^n_k} = \binom{n+k-1}{k}$.  
%\footnotesize
%$$S^3_{2} = \{ (3,0,0), (0,3,0), (0,0,3), (2,1,0), (2,0,1), (1,2,0), (0,2,1), (1, 0, 2), (0, 1,2), (1,1,1) \} \,.$$
\end{exampleblock}
\pause
%\begin{block}{}

%\vspace{-5mm}
%\begin{align*}
%S^4_{2} = \{ \bleu{(2,0,0,0), (0,2,0,0)}, &(0,0,2,0), (0,0,0,2), \bleu{(1,1,0,0)}, \\
%& (1,0,1,0), (1,0,0,1), (0,1,1,0), (0,1,0,1), (0,0,1,1) \}  \\
%\end{align*}
%\end{block}


\smallskip
% \vspace{-2mm}
% Combining results from \ver{Braeken and Semaev (FSE, 2005)} on the ANF of addition and multiplication:

\begin{alertblock}{}
{ \textbf{Theorem (Exponents of $F^{m, n}$).} }
 \vspace{-3mm}
 $$\exponents_{\rouge{\vecx}}(F^{m, n}) \subset \bigcup_{k = 1}^{m} S^n_k \,.$$

 \textit{i.e.} if $ \alpha_{\vecv} \neq 0 $ then $\vecv$ must satifsy $\sum_{i = 0}^{n-1} v_i \leq m$.
\end{alertblock}

% \pause
% \footnotesize
% \begin{block}{}
% $\exponents_{\rouge{\vecx}}(F^{2, 4}) = S^4_{2} \cup S^4_{1}$. 
% \footnotesize
% \begin{align*}
% S^4_{2} = \{ \bleu{(2,0,0,0), (0,2,0,0)}, &(0,0,2,0), (0,0,0,2), \bleu{(1,1,0,0)}, \\
% & (1,0,1,0), (1,0,0,1), (0,1,1,0), (0,1,0,1), (0,0,1,1) \}  \\
% S^4_{1} = \{ (1,0,0,0), (0,1,0,0), &(0,0,1,0), \bleu{(0,0,0,1)} \} \,. 
% \end{align*}
% \small
% Thus possible $\rouge{\vecx^{\vecv}}$: $\bleu{x_0^2} , \  \bleu{x_1^2}  \ , \ldots, \ \bleu{x_0^1x_1^1} \, \ldots, \bleu{x_3^1}$
% \end{block}
\pause
\begin{exampleblock}{}
  \begin{itemize}
    \item \textbf{Proven using [Braeken \& Semaev FSE05].} 
    
    If $G(\vecx) =  x_0 + x_1 + \cdots + x_{n-1} \in \ZZ_{2^q}$, then $\exponents_{\vecx}(G^m) = S^n_m$
    \item Related to the properties of \textbf{S-functions} \hfill [MouCanIndPre09]
  \end{itemize}
  
\end{exampleblock}

% \pause
% \flushleft
% \vspace{-5mm}
% \hfill \rouge{\textbf{Work in progress:} equality when $m$ a power of two.}

\end{frame}




\begin{frame}{A `free' improvement}

%\footnotesize
\begin{alertblock}{}
\begin{itemize}
\item \textbf{Number of monomials.} $\card{\exponents_{\rouge{\vecx}}(F^{m, n})} \leq \card{\bigcup_{k = 1}^{m} S^n_k} = \binom{n+m}{m}$.

\hfill \rouge{Open question : we conjecture equality when $m$ is a power of two.}
\item  \textbf{Degree.} $\deg(F^{m,n}) \leq m$. Equality holds when $m \leq n$.%, $\deg_{\rouge{\vecx}}(F^{m,n}) = m$.

\end{itemize}
\end{alertblock}

\pause
\begin{exampleblock}{}
\begin{itemize}

\item Recall over $\ZZ_{2^q}$: $\binom{n + 2^{q-p}}{2^{q-p}}$ monomials. \hfill [Arora \& Ge] 

\pause
\medskip 

\item If we use the LSB of the sample ($m = 2^{q-p}$), \rouge{same number of monomials} (Surprising!).

\pause
\medskip
\item Free benefit of working over \ver{$\FF_2$} rather than $\ZZ_{2^q}$: 
\begin{enumerate}
\item  operations are \rouge{cheaper} (we gain at least $q$). 
\smallskip
\item  it's a field. 
\end{enumerate}

\end{itemize}
\end{exampleblock}

% \pause
% \textbf{NB:} Once the $q-p$ LSBs are recovered, the cost of recovering the full secret is \bleu{negligible}. 
 
\end{frame}



\begin{frame}{The general strategy}

 \begin{exampleblock}{}
  \begin{enumerate}
    \item With $\binom{n + 2^{q-p}}{2^{q-p}}$ samples, recover the $q-p$ LSBs of each $\rouge{x_i}$ by linearisation.
    \item Observe that each bit of $\langle \ver{\veca}, \rouge{\vecx}\rangle$ satisfies $b_{j} = \sum_{i = 0}^{n-1}\ver{\veca_{i, j}}\rouge{\vecx_{i, j}} + \bleu{c_j}$ where $\bleu{c_j}$ is a carry.
    \item  Compute $\bleu{c_j}$ from the known $\ver{a_{i, k}}$'s and recovered $\rouge{x_{i, k}}$'s. 
    \item Solve a linear system in $\rouge{\vecx_{i,j}}$ only.
    \item Repeat for increasing $j$.
  \end{enumerate}
 \end{exampleblock} 

The cost of steps 2 to 5 is \bleu{negligible} before the cost of step 1.
 
\end{frame}
%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{Effective computation of the ANF}

%\footnotesize
\begin{exampleblock}{}
We improve Arora \& Ge generically\dots \only<2->{as long as we can compute the ANF\dots} 
\end{exampleblock}


\pause 
\pause
\flushleft
This is \textit{a priori} hard: 
\begin{itemize}
\item Möbius transform is out-of-scope (the LUT cannot be fully computed/stored)
\item Direct computations using recursive formulas seem hopeless.
\end{itemize}
%$F^{m, n}$ depends on at most $\rouge{2n \cdot (\lfloor \log_2(m) \rfloor + 1)}$ with $n > 128$. 

% \begin{itemize}
% \item \textbf{Möbius transform} costs \ver{$s2^{s-1}$ in time} and \bleu{$2^s$ in memory} where $s$ is the number of variables. 
% \smallskip
% \item \textbf{Number of variables.} $F^{m, n}$ depends on at most $\rouge{s = n \cdot (\lfloor \log_2(m) \rfloor + 1)}$ variables of $\vecx$.
% \end{itemize}
%\end{alertblock}
%NB: this simply comes from the fact that the ith bit of the sum depends only on the i-1 LSBs of the terms.

\begin{alertblock}{Our result}
\centering
The ANF can be `understood' for \rouge{arbitrary large $n$} and for \rouge{$m$ up to $16$} by:
\vspace{.2cm}
\begin{itemize}
\item storing the ANF for a small value of $n'$.
\item computing relevant parts of the ANF or properties for arbitrary large $n \geq n'$.
\end{itemize}
\end{alertblock}

\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{Additional improvement of the attack}

% \footnotesize
\flushleft

Default linearisation: one auxiliary variable per monomial $\vecx^{\vecv}$ in the ANF of $F^{m,n}$. 

\begin{block}{}
\textbf{Example}. 
% \vspace{-6mm}
\begin{align*}
F(\ver{\veca}, \rouge{\vecx}) &= \alpha_{\vecv}\rouge{\vecx^{\vecv}} + \alpha_{\vecv'}\rouge{\vecx^{\vecv'}} + \alpha_{\vecv''}\rouge{\vecx^{\vecv''}} + \cdots 
\quad \quad \alpha_{\vecv},\alpha_{\vecv'},\alpha_{\vecv''} \in \FF_2[\ver{\veca}]
\end{align*}

\begin{itemize}
\item If $\alpha_{\vecv} = \alpha_{\vecv'}$, then $\rouge{\vecx^{\vecv}}$ and $\rouge{\vecx^{\vecv'}}$ appear/vanish together for any value of $\ver{\veca}$.
\item It makes sense to introduce $y = \rouge{\vecx^{\vecv}} + \rouge{\vecx^{\vecv'}}$. 
\end{itemize}

\end{block}

\pause

\begin{itemize}
\item Less variables: improved linearisation (data and time).
\item Ideally: compute the rank and a basis for $\{\alpha_{\vecv}, \vecv \in \exponents(F^{m, n})\}$.  \hfill \rouge{Work in progress} 
\end{itemize} 

\pause

\begin{alertblock}{}
%\textbf{Additional parameters} (fixed $m$, arbitrary large $n$)
\begin{itemize} 
\item In practice, we compute the generating family $Q^{m,n}$ made of distinct $\alpha_{\vecv}$'s. \hfill \rouge{$m \leq 16$}. 
\item The average sparsity for both families (monomials, $Q^{m,n}$). \hfill \rouge{$m \leq 8$}. 
\end{itemize}
\end{alertblock}


\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{Our results: Upper bound on the rank}

%\small
\flushleft
\textbf{Ratio $ \card{Q^{m,n}} / \binom{n+m}{m}-1$ as a function of $n$, for $n \in \intset{m,  4096}$}.

\begin{figure}[t]
    \centering
    \includegraphics[width=0.9\linewidth]{02_10_25_plot.pdf}
   % \caption{$\frac{\card{\mathcal{Q}^{m,n}}}{\card{\exponents_{\vecx}(F^{m,n})}}$ as a function of $n$, for $n \in \intset{m,  4096}$.} 
    %\label{fig:rank}
\end{figure}


\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{Our results: Sparsity}

\flushleft
% \small 
\textbf{Average fraction of terms in a random equation $F^{m, n}_{\veca}(\vecx)$ as a function of $n$.}
\begin{figure}[t]
    \centering
    \includegraphics[width=0.9\linewidth]{02_10_25_avg_sparsity_Qnm.pdf}
    %\caption{} 
  %  \label{fig:sparsity}
\end{figure}

\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{Improvements over Arora-Ge}

\flushleft
\small

\textbf{Comparison to the linearisation attack by Arora \& Ge using $\omega = 3$}.

\hfill and cost of modular addition/multiplication $\approx q-p$.

\begin{table}[]
    \centering
    \setlength{\tabcolsep}{5pt}
    \renewcommand{\arraystretch}{.6}
    \begin{tabular}{cc|c|c|c}
        \toprule
        $m = 2^{q-p}$ & $n$ & \makecell{Arora-Ge} & \makecell{Our work\\ {\small ($\leq$ rank only)}}  &  \makecell{Our work\\ {\small ($\leq$ rank and sparsity)}} \\
        \midrule
        
        &  $64$  & $2^{106.4}$ & \rouge{$2^{97.8}$} &  \bleu{$2^{87.2}$} \\
       \multirow{-1}{*}{$8$}  & $128$ & $2^{129.3}$ & \rouge{$2^{121.8}$} & \bleu{$2^{110.8}$}\\
        & \ $256$ \ & $2^{152.7}$ & \rouge{$2^{145.9}$} & \bleu{$2^{134.7}$} \\
        \midrule
        & $64$  & $2^{170.7}$ &  \rouge{$2^{157.2}$}& {\small Non-available} \\
        \multirow{-1}{*}{\ $16$ \ } & $128$ & $2^{214.6}$ &  \rouge{$2^{202.00}$}& {\small Non-available} \\
        & $256$ & $2^{260.5}$ & \rouge{$2^{250.1}$} & {\small Non-available} \\
        \bottomrule
    \end{tabular}
    \vspace{1mm}
\end{table}

\end{frame}



%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%

\section{Some intuition}

\begin{frame}{Overview}

\small%\footnotesize 
\flushleft
\vspace{-5mm}
\begin{alertblock}{Our result}
\centering
The ANF (and additionnal properties) can be understood for \rouge{arbitrary large $n$} and for \rouge{$m$ up to $16$}. 
\end{alertblock}
\hfill {\scriptsize NB: these $m$ are used in practice $m = 8$ for SABER, $m = 16$ for LaKEY.}
%More precisely: relevant metrics e.g. number of monomials. 

\medskip

We take advantage of symmetries due to \ver{commutativity of modular addition}. 

%\footnotesize
\begin{block}{}
Observe that:
\begin{itemize}
  \item $\langle (a_0, a_1), (x_0, x_1) \rangle = a_0x_0 + a_1x_1 = a_1x_1 + a_0x_0 = \langle (a_1, a_0), (x_1, x_0) \rangle$.\pause
  \item More generally for any $n$ and any permutation $\sigma \in \Sfrak_n$,  $\langle \veca, \vecx \rangle = \langle \sigma \cdot \veca, \sigma \cdot \vecx  \rangle $.
\end{itemize}  
% $
% F^{m,n} (\veca,\vecx) = \left( \langle  \veca ,  \vecx \rangle \right)^m  = (\sum_{0 \leq i < n} a_i \times x_i)^m \,. 
% $

% \medskip
% We define $\rouge{(0 \ 1)} \cdot {\veca} \coloneq (a_{\rouge{1}}, a_{\rouge{0}}, a_2, \ldots, a_{n-1}) ,\rouge{(0 \ 1)} \cdot \vecx \coloneq (x_{\rouge{1}}, x_{\rouge{0}}, x_2, \ldots, x_{n-1})$. 

% \smallskip
% Then 
% \begin{align*}
% (\veca, \vecx) \mapsto F^{m,n}(\veca, \vecx) \qquad \text{and} \qquad (\veca, \vecx) \mapsto F^{m,n}(\rouge{(0 \ 1)} \cdot {\veca} , \rouge{(0 \ 1)} \cdot \vecx)
% \end{align*}
% are the same functions since $a_0 \times x_0 + a_1 \times x_1 = a_1 \times x_1 + a_0 \times x_0$. 
\end{block}
\pause

\begin{block}{}
Observe that:
\begin{itemize}
  \item $\langle (a_0, a_1, 0), (x_0, x_1, 0) \rangle = a_0x_0 + a_1x_1  = \langle (a_0, a_1), (x_0, x_1) \rangle$.\pause
  \item More generally for any $n \leq n'$, $\langle \veca || 0^{n'-n}, \vecx || 0^{n'-n} \rangle_{n'} = \langle \sigma \cdot \veca, \sigma \cdot \vecx  \rangle_{n} $.
\end{itemize}  

\end{block}
% \begin{itemize}
% \item Generalizes to any arbitrary permutation $\sigma$ in $\Sfrak_n$: notion of \rouge{$\Sfrak_n$-invariant function} (not symmetric!). 
% \end{itemize}

\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{Reduction to a system of representatives}

%\footnotesize
\small

\begin{exampleblock}{}
\begin{itemize}
\item The group $\Sfrak_n$ acts on vectors of length $n$:  $\sigma \cdot \vecu \coloneq (u_{\sigma^{-1}(0)}, \ldots, u_{\sigma^{-1}(n-1)})$.

\item $F(\veca, \vecx)$ is said $\Sfrak_n$-invariant if $F(\veca, \vecx) = F(\sigma \cdot \veca, \sigma \cdot \vecx)$ for all $\sigma \in \Sfrak_n$.
\end{itemize}
\end{exampleblock}
\pause

\begin{block}{}
\textbf{Example.} 
The function  
$F : (\veca, \vecx) \mapsto \veca^{(1,0)} \vecx^{(3,0) } + \veca^{(0,1)} \vecx^{(0,3) } $ %= a_0^1x_0^3 + a_1^1x_1^3 $$
is $\Sfrak_2$-invariant (not symmetric!) 

\vspace{.2cm}

Indeed, $\Sfrak_2 = \{ \mathrm{id}, \bleu{(0 \ 1)} \}$ and 
 $ \bleu{(0 \ 1)} \cdot F = F( \bleu{(0 \ 1)} \cdot \veca, \bleu{(0 \ 1)} \cdot \vecx) = F(\veca, \vecx) \,.$

\pause
%\textbf{Remarks:} $\alpha_{\vecu, \vecv} \in \FF_2$ coefficient of $\veca^{\vecu} \vecx^{\vecv}$, $\alpha_{\vecv} \in \FF_2[\veca]$ (mod field equations) coeff of $\vecx^{\vecv}$. 
\vspace{.2cm}
\begin{minipage}{0.45\textwidth}
\begin{itemize}
\item $\alpha_{(1,0),(3,0)} = \alpha_{(0,1),(0,3)}$.
\end{itemize}
\end{minipage}
\begin{minipage}{0.5\textwidth}
\begin{itemize}
\item $\alpha_{(3,0)} = \veca^{(1,0)} \neq  \veca^{(0,1)} = \alpha_{(0,3)}$. 
\end{itemize}
\end{minipage}
\end{block}

\pause


\begin{alertblock}{}
For any $m, n$, \rouge{$F^{m, n}$ is $\Sfrak_n$-invariant}. This is equivalent to: 
%\begin{minipage}{0.5\textwidth}
\begin{itemize}
\item $\forall \vecu, \vecv, \sigma, \quad \quad \alpha_{(\sigma \cdot \vecu, \sigma \cdot \vecv)} = \alpha_{(\vecu,\vecv)}$ \hfill $\alpha_{\vecu, \vecv} \in \FF_2$ %for any $\vecu, \vecv$, $\sigma \in \Sfrak_n$. 
 \item $\forall \vecu, \sigma, \quad \quad  \sigma \cdot \alpha_{\vecv}  = \alpha_{\sigma^{-1} \cdot \vecv}$\hfill $\alpha_{\vecv} \in \FF_2[\veca]$% for any $\vecv$, $\sigma \in \Sfrak_n$. 
\end{itemize}
%\end{minipage}

\smallskip
\centering \rouge{Allows to represent the ANF in a compact way.} 

\end{alertblock}
\end{frame}


%%%%%%%
%%%%%%%
%%%%%%%


\begin{frame}{Scaling}
\small
How do we get results for \rouge{arbitrary $n$}?

\footnotesize
\flushleft
\begin{block}{}
\textbf{Example.} 
Let's look at the $\Sfrak_{\rouge{3}}$-invariant function 

$$F^{\rouge{(3)}} ((\bleu{a_0, a_1},a_2),(\bleu{x_0, x_1}, x_2))  \mapsto \bleu{\veca^{(1,0,0)} \vecx^{(3,0,0) } + \veca^{(0,1,0)} \vecx^{(0,3,0) }} + \veca^{(0,0,1)} \vecx^{(0,0,1) } \,. $$

Then 
$$F^{\rouge{(3)}} ((\bleu{a_0, a_1},0),(\bleu{x_0, x_1}, 0)) =  \bleu{\veca^{(1,0)} \vecx^{(3,0) } + \veca^{(0,1)} \vecx^{(0,3) }  } \,.$$

is $\Sfrak_{\bleu{2}}$-invariant. 

\end{block}

%\pause
%What does $F^{\rouge{(3)}}$ look like? 
%
%\begin{block}{}
%\begin{enumerate}
%\item Since $F^{\rouge{(3)}} ((a_0, a_1,0),(x_0, x_1, 0)) = F^{\bleu{(2)}}((a_0, a_1),(x_0,x_1))$, 
%\vspace{-2mm}
%$$F^{\rouge{(3)}} ((\bleu{a_0, a_1},a_2),(\bleu{x_0, x_1}, x_2))  =  \bleu{\veca^{(1,0,0)} \vecx^{(3,0,0) } + \veca^{(0,1,0)} \vecx^{(0,3,0) }} + ...$$
%In other words:
%\vspace{-2mm}
%$$ \alpha_{(\bleu{u_0, u_1}, 0), (\bleu{v_0, v_1}, 0)}(F^{\rouge{(3)}}) = \alpha_{\bleu{(u_0, u_1)}, \bleu{(v_0, v_1)}}(F^{\bleu{(2)}})  \,. $$
%
%\vspace{-1mm}
%\pause
%\item By $\Sfrak_{\rouge{3}}$-invariance of $F^{\rouge{(3)}}$, for all $\vecu, \vecv \in \ZZ_{2^q}^{\rouge{3}}$,
%$$
%\alpha_{(\sigma \cdot \vecu, \sigma \cdot \vecv)} = \alpha_{(\vecu, \vecv)}
%$$
%\end{enumerate}

%\vspace{-2mm}
%\end{block}

\pause


\begin{itemize}
\item Conversely, all terms of support of cardinal at most $m$ in the ANF of $F^{(n)}$ can be understood from the ANF of $F^{(m)}$.

\pause
\medskip
\item \textbf{Using $m$} you can bound the cardinal of the support. 
\end{itemize}

\begin{alertblock}{}
\centering
(Properties of) $F^{m,n}$ can be derived from $F^{m,m}$.
\end{alertblock}

\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\section{A taste of the algorithms}

\begin{frame}{Group actions}

\footnotesize
\begin{exampleblock}{}
Let $\GG$ be a group acting on a set $E$. Let $x \in E$. 
\begin{itemize}
\item \textbf{Orbit.} $\orb(x) \coloneq \{ \sigma \cdot x, \ \sigma \in \GG \} \subset E$. 
\item \textbf{Stabilizer.} $\stab(x) \coloneq \{ \sigma, \ \sigma \cdot x = x \} < \GG$. 
\end{itemize}
\end{exampleblock}

\begin{block}{}
\textbf{Example.} 
Let $\vecv = (\rouge{3},1,\ver{1})$. Then $\orb(\vecv) = \{  (3,1,1), (1,3,1), (1,1,3) \}$ and  $\stab(\vecv) = \{  \textrm{id}, (1 \ 2) \}$. %$\Sfrak_3 = \{ \textrm{id}, (0 \ 1), (0 \ 2), (2 \ 1), (0 \ 1\ 2), (0 \ 2\ 1) \}$. 
% \begin{itemize}
% \item . 
% \item . 
% \end{itemize}
\end{block}

\flushleft

\begin{alertblock}{}
  \textbf{Important properties}.
\begin{itemize}
\item The set of orbits $\{\orb(x), \ x \in E\}$ is a partition of E. 
\item It induces an equivalence relation : $x \sim x'$ if and only if $x' \in \orb(x)$.
\item For any $x \in E$,
\vspace{-2mm}
\begin{align*}
\card{\orb(x)} \cdot \card{\stab(x)} = \card{\GG} \,. 
\end{align*}
\end{itemize}

\vspace{-2mm}
\end{alertblock}

\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\begin{comment}
\begin{frame}{$\Sfrak_n$-invariant Boolean functions}

\footnotesize
\flushleft
%We can   
The action on monomials extends linearly to \textbf{Boolean functions}. \hfill  \scriptsize (since  $\sigma \cdot (\veca^{\vecu }\vecx^{\vecv}) = (\sigma \cdot \veca)^{\vecu} (\sigma \cdot \vecx)^{\vecv}$)

\footnotesize
\begin{exampleblock}{}
Let $\bleu{f \in \ZZ_{2^{q}}^n \rightarrow \FF_2}$, $\rouge{F : \ZZ_{2^{q}}^n \times \ZZ_{2^{q}}^n \rightarrow \FF_2}$. We define $\sigma \cdot \bleu{f}$ and $\sigma \cdot \rouge{F}$ as:
$$
\sigma \cdot \bleu{f} (\vecx) = \bleu{f} (\sigma \cdot \vecx) \quad \text{ and } \quad \sigma \cdot \rouge{F}(\veca, \vecx) \coloneq \rouge{F}(\sigma \cdot \veca,\sigma \cdot \vecx) \,.
$$
%    $$
%    \rowcolors{5}{white}{white}
%\begin{array}{ccccccc}
%    \Sfrak_n \times \FF_2^{(\ZZ_{2^{q}}^n)} &\longrightarrow&  \FF_2^{(\ZZ_{2^{q}}^n)} &\quad \quad \quad \quad\quad&    \Sfrak_n \times \FF_2^{(\ZZ_{2^{q}}^n \times \ZZ_{2^{q}}^n)} &\longrightarrow&  \FF_2^{(\ZZ_{2^{q}}^n)} \\
%       (\sigma, f)  &\longmapsto&  \sigma \cdot f& \quad \quad \quad \quad\quad &(\sigma, F)  &\longmapsto& \sigma \cdot F\,, 
%\end{array}
%$$
%with $\sigma \cdot f (\vecx) = f(\sigma \cdot \vecx)$ and $\sigma \cdot F(\veca, \vecx) \coloneq  F(\sigma \cdot \veca,\sigma \cdot \vecx)$.
\end{exampleblock}

\flushleft
To formalise the \ver{symmetries} of $F^{m,n}$, we introduce the notion of \rouge{\textbf{$\GG$-invariance}}.
\begin{alertblock}{}
Let $\GG$ be a subgroup of $\Sfrak_n$. The function $ \bleu{f} $ (resp. $\rouge{F}$) is \rouge{$\GG$-invariant} if it satisfies:
$$ \forall  \sigma \in \GG, \quad \sigma \cdot  \bleu{f}  =  \bleu{f}  \quad \text{ (resp. } \quad\forall  \sigma \in \GG, \quad \sigma \cdot \rouge{F} = \rouge{F} \text{)}\,. $$
\end{alertblock}
%{\scriptsize In the presentation, we will use only $\Sfrak_n$-invariance.}
%This is strictly equivalent to $\GG \subset \stab(f)$ (resp. $\GG \subset \stab(F)$). 




\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{Reduction to a system of representatives}
\footnotesize
\flushleft
Let $F : \ZZ_{2^q}^n \times  \ZZ_{2^q}^n \longmapsto \FF_2^n$. Recall
\begin{align*}
F(\ver{\veca}, \rouge{\vecx}) = \sum_{(\ver{\vecu},\rouge{\vecv}) \in \ZZ_{2^q}^n \times \ZZ_{2^q}^n  } \alpha_{(\ver{\vecu}, \rouge{\vecv})}(F) \ver{\veca^{\vecu}} \rouge{\vecx^{\vecv}} = \sum_{\rouge{\vecv} \in \ZZ_{2^q}^n} \alpha_{\rouge{\vecv}}(F) \rouge{\vecx^{\vecv}} \quad \text{ where } \quad \alpha_{\rouge{\vecv}}(F) = \sum_{\ver{\vecu} \in \ZZ_{2^q}^n} \alpha_{\ver{\vecu}, \rouge{\vecv}}(F) \ver{\veca^{\vecu}} \,.
\end{align*}

\pause
\begin{exampleblock}{}
Let $\GG$ be a subgroup of $\Sfrak_n$. The following statements are equivalent:
\begin{itemize}
\item[(i)] $F$ is $\GG$-invariant. 
\item[(ii)]  $\forall \sigma \in \GG, \forall \vecu \in \ZZ_{2^q}^n, \forall \vecv \in \ZZ_{2^q}^n, \quad \rouge{\alpha_{\sigma \cdot (\vecu, \vecv)}(F) = \alpha_{(\vecu,\vecv)}(F)}$.
 \item[(iii)] $\forall \sigma \in \GG, \forall \vecv \in \ZZ_{2^q}^n, \quad \bleu{\sigma \cdot \alpha_{\vecv}(F)  = \alpha_{\sigma^{-1} \cdot \vecv}(F)}$. 
 \end{itemize}
\end{exampleblock}

\pause
By commutativity of modular addition:
\small
\begin{alertblock}{}
\centering
$F^{m,n}$ is $\Sfrak_n$-invariant. 
\end{alertblock}

\pause
\footnotesize
\begin{itemize}
\item We can study $\{\alpha_{\ver{\vecu}, \rouge{\vecv}}(F^{m,n}) \}$ using one element per orbit. 
\item Coefficients $\alpha_{\rouge{\vecv}}(F^{m,n})$ and $\alpha_{\rouge{\vecv'}}(F^{m,n})$ such that $\rouge{\vecv} \sim \rouge{\vecv'}$ can computed one from the other.
\end{itemize}

\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{Scaling}

\footnotesize
\begin{alertblock}{}
    Let $m \in \NN^{\star}$ and $\vecu,\vecv \in \NN^d$. 
    For any $n \geq d$, $\sigma \in \Sfrak_{n}$, 
    \begin{align*}
        \alpha_{(\vecu,\vecv)}(F^{m,d}) = \alpha_{\sigma \cdot (\tilde\vecu, \tilde\vecv)} (F^{m,n}) \,,
    \end{align*}
where
$$
\tilde{\vecu}
=
\bigl(
u_0,\dots,u_{d-1},
\underbrace{0,\dots,0}_{n-d\text{ zeros}}
\bigr)
\qquad 
\tilde{\vecv}
=
\bigl(
v_0,\dots,v_{d-1},
\underbrace{0,\dots,0}_{n-d\text{ zeros}}
\bigr) \,.
$$
%{\rowcolors{2}{}{}
%$$\forall i \in \intset{0, n-1}, \  \tilde{u}_i \coloneq \begin{cases}
%  u_i & \text{if } i \leq d-1 \\    
%  0 & \text{if } d \leq i
%\end{cases} \ \text{and} \ \tilde{v}_i \coloneq 
%\begin{cases}
%  v_i & \text{if } i \leq d-1 \\    
%  0 & \text{if } d \leq i
%\end{cases} \,.$$
%}
\end{alertblock}

\pause

\begin{itemize}
\item $F^{m,m}$ allows to understand $F^{m,n}$ for all $n \geq m$. 
\pause
\item Any term of $F^{m,n}$ with a support of size $d$ can be derived from $F^{m,d}$. 
\end{itemize}

\pause
\flushleft
\textbf{Underlying assumption:} for all $\vecu, \vecv$ such that $\alpha_{\vecu, \vecv}\neq0$, $\supp(\vecu) = \supp(\vecv)$. Stems from:
\begin{align*} 
F^{m,n} (\veca,\vecx) = (\langle \veca, \vecx \rangle)^m  = \Bigl(\sum \rouge{a_i x_i} \Bigr)^m \,.
\end{align*}
%
%\begin{block}{}
%\textbf{Example.} $d = 2$, $n = 3$. Let $\vecu = (1,2)$, $\vecv = (1,1)$. Then $\tilde{\vecu} = (1,2,0)$,  $\tilde{\vecv} = (1,1,0)$. 
%\end{block}

\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\end{comment} 

\begin{frame}{Effective computation of the ANF}
\footnotesize
\flushleft
\vspace{-5mm}
Recall: \rouge{$S^n_m$ ordered} partitions of length $n$ of $m$. Let \bleu{$\mathcal{C}^n_m$} be a system of representatives (\bleu{unordered} partitions). 

\begin{exampleblock}{}
\vspace{-5mm}
    \begin{align*}
        F^{m,n} (\veca, \vecx) = \sum_{\substack{ \vecc \in \bleu{\C^n_{m}}} } 
\only<1>{\sum_{\vecc' \in \orb(\vecc) } \  \prod_{i = 0}^{n-1} (a_i \times x_i)^{c'_i} }
\only<2>{\sum_{\vecc' \in \orb(\vecc) } \  \ver{\prod_{i = 0}^{n-1} (a_i \times x_i)^{c'_i}} }
\only<3>{\rouge{ \sum_{\vecc' \in \orb(\vecc) } \  \prod_{i = 0}^{n-1} (a_i \times x_i)^{c'_i}} }
\only<4->{\sum_{\vecc' \in \orb(\vecc) } \ \prod_{i = 0}^{n-1} (a_i \times x_i)^{c'_i}}
        = \sum_{\substack{  \bleu{\vecc \in \C^n_{m}}} } 
\only<1>{\sum_{ \vecc' \in \orb(\vecc)}  H_{\vecc'}( \veca, \vecx)}
\only<2>{\sum_{ \vecc' \in \orb(\vecc)}  \ver{H_{\vecc'}( \veca, \vecx)}}
\only<3>{ \rouge{ \sum_{ \vecc' \in \orb(\vecc)} H_{\vecc'}( \veca, \vecx)}}
\only<4->{\sum_{ \vecc' \in \orb(\vecc)}  H_{\vecc'}( \veca, \vecx)}
  =  \sum_{\substack{ \bleu{\vecc \in \C^n_{m}}} }   
  \only<1,2>{
  G_{\vecc}( \veca, \vecx) }
  \only<3>{
    \rouge{G_{\vecc}( \veca, \vecx) }}
  \only<4->{
    G_{\vecc}( \veca, \vecx) 
    }   \,. %= \sum_{\substack{ \vecc \in \C^n_{m}} } G_{\vecc}(\veca,\vecx) \,, 
\end{align*}
\vspace{-2mm}
\end{exampleblock}

\pause
\pause
\begin{alertblock}{}
 \textbf{Theorem.}   Let $\vecc \in \ZZ_{2^q}^n$, $(\vecu, \vecv) \in \ZZ_{2^q}^n \times \ZZ_{2^q}^n$. Define
    $E_{\vecc}(\vecu, \vecv) \coloneq \exponents(H_{\vecc}) \cap \orb(\vecu, \vecv)$.
    For any $\sigma \in \Sfrak_n$,
    \begin{align*}
         \alpha_{\sigma \cdot (\vecu, \vecv)}(G_{\vecc}) \quad = \quad  \alpha_{(\vecu, \vecv)} (G_{\vecc})\quad  = \quad  \frac{\card{E_{\vecc}(\vecu,\vecv)}n!}{\card{\stab(\vecc)}\card{\orb(\vecu, \vecv)}} \mod{2} \,. 
    \end{align*}
\end{alertblock}

\pause
\begin{itemize}
\item[(i)] For all canonical $\vecc$, compute ${\{ (\vecu, \vecv)^{\star}, \alpha_{(\vecu, \vecv)^{\star} } (G_{\vecc}) = 1 \}}$ from $H_{\vecc'}$ for some $\vecc' \in \orb(\vecc)$. (Theorem) 
%\pause $\rhd \ \exponents^\star(G_{\vecc}) \coloneq \{(\vecu, \vecv)^{\star} \ | \ \alpha_{(\vecu, \vecv)^{\star}}(G_{\vecc}) =1\}$
\pause
\item[(ii)] Compute a SOR of the ANF of $F^{m,n}$ from the $G_{\vecc}$'s i.e. $\ver{\{ (\vecu, \vecv)^{\star}, \alpha_{(\vecu, \vecv)^{\star} } (F^{m,n}) = 1 \}}$. % for some $\vecc' \in \orb(\vecc)$. \hfill $\rhd \ \exponents^\star(G_{\vecc}) \coloneq \{(\vecu, \vecv)^{\star} \ | \ \alpha_{(\vecu, \vecv)^{\star}}(G_{\vecc}) =1\}$
%\item[(i)] Compute ANF of $G_{\vecc}$ from $H_{\vecc'}$ for a single $\vecc' \in \orb(\vecc)$. \hfill $\rhd \ \exponents^\star(G_{\vecc}) \coloneq \{(\vecu, \vecv)^{\star} \ | \ \alpha_{(\vecu, \vecv)^{\star}}(G_{\vecc}) =1\}$
\pause
\item[(iii)] Compute the \rouge{multiset $\{\!\{ \alpha_{\vecv^{\star}}(F^{m,n}) \neq 0 \}\!\}$}. %with cardinal equal to $\card{\{\vecv^{\star},  \alpha_{\vecv^{\star}\}} \neq 0}$. 
\end{itemize}

\vspace{-1mm}
\hfill {\scriptsize \textbf{NB:} $\{ \alpha_{\vecv^{\star}}(F^{m,n}) \neq 0 \}$ is \rouge{not} a SOR of $\{ \alpha_{\vecv}(F^{m,n}) \neq 0 \} /\! \sim$}. 

\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{Effective computation of the number of monomials}
\flushleft
\footnotesize

\vspace{-4mm}
\textbf{Recall.} For each random $\ver{\veca}$, the function in $\{ F^{m,n}_{\ver{\veca}} \coloneq F^{m,n}({\ver{\veca}} , \cdot) \}$ is evaluated on the secret \rouge{$\vecx$} to yield $s_{\ver{\veca}}$. 

\smallskip
If we can compute the ANF of $F^{m,n}_{\ver{\veca}}$, we obtain an equation in the secret \rouge{$\vecx$}:
\begin{align*}
\sum_{\vecv \in (\FF_{2}^q)^n} \alpha_{\vecv}(F^{m,n}_{\ver{\veca}}) \ \rouge{\vecx}^{\vecv}  = \sum_{\vecv \in (\FF_{2}^q)^n} \alpha_{\vecv}(F^{m,n})(\ver{\veca}) \ \rouge{\vecx}^{\vecv}  = (s_{\ver{\veca}})^{m/2^{q-p}} \,. 
\end{align*}

\pause

\vspace{-2mm}
\begin{exampleblock}{}
\textbf{NB:} Number of monomials in the system: 
$$\card{\bigcup_{\veca \in \ZZ_{2^q}^n} \{\vecv, \alpha_{\vecv}(F^{m,n}_{\veca}) \neq 0 \}} =  \card{\{ \vecv, \alpha_{\vecv}(F^{m,n}) \neq 0 \}}  \,. $$
\end{exampleblock}

\pause

\begin{itemize}
\item Our algorithm returned the \rouge{multiset $\{\!\{ \alpha_{\vecv^{\star}}(F^{m,n}) \neq 0 \}\!\}$}, which has cardinal equal to $\card{\{\vecv^{\star},  \alpha_{\vecv^{\star}\}} \neq 0}$.
\end{itemize}

\small
\centering
$\text{ Nr of monomials } =  \card{\{ \vecv, \alpha_{\vecv} \neq 0 \} } =  \sum_{\vecv^{\star},  \alpha_{\vecv^{\star}} \neq 0} \orb(\alpha_{\vecv^{\star}}) \binom{n}{\card{\supp(\vecv^{\star})}}$

\pause

\smallskip
\begin{alertblock}{}
\centering
In practice, when $m$ is a power of two, this is \rouge{always} equal to the upper bound $\binom{n+m}{m} - 1$. 
\end{alertblock}

%dire qq part que nombre de monomes vaut tant pour m puissance de 2

%dire définition de Qmn

\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%

\begin{frame}{Conclusion}
\flushleft
\small
\textbf{Results}
\begin{itemize}
\item Deterministic noise impacts practical complexity.

\medskip  
\item Generic improvement over Arora \& Ge:
\begin{itemize}
\item same number of monomials + working over $\FF_2$.

\smallskip
\item computation of additional parameters.
\end{itemize}

\item Other stuff e.g.: Time-data trade-offs work \rouge{better} in mod/ring LWR.

\end{itemize}

\medskip
\textbf{Many, many open questions}
\begin{itemize}
\item Understanding the ANF even better (work in progress).

\medskip

\item Help us solve this system (with less data)! 

\begin{itemize}
\item E.g. super structured ANF guides guess-and-solve strategies.
\end{itemize}

\medskip
\item More applications of group actions. 

\end{itemize}

\end{frame}


%%%%%%%
%%%%%%%
%%%%%%%

%\begin{frame}{Conclusion and open problems}
%
%\flushleft
%\small
%
%\textbf{Resolution techniques}
%
%Other observations (see the paper): Surrepresentation of LSBs (of $\veca$ and $\vecx$).
%\begin{itemize}
%\item In guess-and-solve strategies: it makes sense to guess LSBs first. 
%\item Time-data trade-offs: wait for $\veca$ with many even $a_i$'s. 
%\end{itemize}
%
%\smallskip
%
%Would love some help with resolution techniques
%
%\smallskip
%
%Remaining mathematical open problems such as proving the nr of monomials. 
%
%\smallskip
%
%Other applications of group actions in symmetric crypto. 
%
%
%\end{frame}

%%%%%%%
%%%%%%%
%%%%%%%


\bibliographystyle{alpha}
%\bibliography{bibpresaes.bib}
\end{document}

