\begin{tikzpicture}[scale=0.27]

\tikzset{SpongePerm/.style=rounded corners=4pt,};
%\tikzset{edge/.style=-latex new, arrow head=8pt, thick};
%\tikzset{edgee/.style=latex new-latex new, arrow head=8pt, thick};


%% 
\begin{scope}[xshift=0cm]


\draw[->,>=latex] (0,4.5) node[left] {  \footnotesize $(\key,\nonce)$} -- ++ (1.3,0);
\draw[->,>=latex] (2.5,10) node[above] {\footnotesize$\associateddata$} -- ++ (0,-1);

\draw[SpongePerm] 
    	(1.5,0) rectangle node { \footnotesize $F_{init}$} ++(2,9);
 
\end{scope}

\begin{scope}[xshift=0.2cm]



\begin{scope}[xshift = 5.9cm]

\foreach \z in {0,1} {
\begin{scope}[xshift=\z*5.9cm]

    \draw (1,9.5) node[above] { \footnotesize $\cipherblock$} -- (1,8);
    
\draw[->,>=latex]  (-2.5,2) -- (-0.3,2)  ;
\draw (0.4,2) node{\footnotesize $x_{\z}$};
%\draw (0,0) rectangle node{\small $x_{\z}$} ++ (1,7);
%\fill[blue!30] (0,7) rectangle  ++ (1,3);
%\draw(0,7) rectangle node{\small $\cipherblock$} ++ (1,3);

\draw[SpongePerm] 
    		(2.3,0) rectangle node {\footnotesize $h$} ++(1,9);


    \draw[->,>=latex] (1,8) -- ++(1.3,0);
    \draw[->,>=latex] (1,2) -- ++(1.3,0);


  \end{scope}
}

\end{scope}
  %%
  
    \begin{scope}[xshift=15.1cm]
    
    \draw[->,>=latex]  (0,8)--++ (1.5,0)  ;
    \draw[->,>=latex]  (0,2)--++ (1.5,0) ;
        \draw (3,8) node {\large \ldots};
    \draw (3,2) node {\large \ldots};

  \end{scope}
%%  

\begin{scope}[xshift=20.7cm]


    %\draw[edge] (-1.5,8) -- ++(1.5,0);
    \draw (1.8,9.5) node[above] {\footnotesize $\cipherblock$} -- (1.8,8);
    
    
%\draw[edge]  (-2.5,2) -- (-0.3,2)  ;
\draw (0.8,2) node{\footnotesize $x_{\cipherlength-1}$};
 
% \fill[red!30] (0,0) rectangle  ++ (1.8,7);
%\draw (0,0) rectangle node{\small $x_{\cipherlength-1}$} ++ (1.8,7);
%\fill[blue!30] (0,7) rectangle  ++ (1.8,3);
%\draw(0,7) rectangle node{\small $\cipherblock$} ++ (1.8,3);
 
  \begin{scope}[xshift=0.8cm]
  \draw[SpongePerm] 
    	(2.5,0) rectangle node { \footnotesize $F_{final}$} ++(2.5,9);
     \draw[->,>=latex] (1,8) -- ++(1.5,0);
          \draw[->,>=latex] (1,2) -- ++(1.5,0);
          
     \draw (5,6) --++ (1.1,0);
    \draw[->,>=latex] (6.1,6) --++ (0,4.3);
   \draw (6.1,10) node[above] {\footnotesize $\tagAEAD$};
\end{scope}

       
\end{scope}
  
\end{scope}


\end{tikzpicture}
