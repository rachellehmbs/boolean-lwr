
\begin{tikzpicture}[scale=0.3]

  \tikzstyle{every node}=[transform shape];

  % Alice
  \node (label) at (0,0) {\includegraphics[height=7cm]{figures/canal_alice_dep.png}};
  \node (alice) at (0,-4) {\Huge\bf Alice};
  

  \node[below = 1em of alice] (alicekey) {\Huge  $\rouge{\key}, N, \rouge{M}$};
  
      \onslide<2,3,4,5,6>{
    \node[below = 1em of alicekey] (ctalice) {\Huge $(\ver{C,T}) = \encryptionalgo(\rouge{\key}, N, \rouge{M})$ };
  }
  
  % Bob
  \node (label) at (30,0) {\includegraphics[height=7cm]{figures/canal_bob_dep.png}};
  \node (bob) at (30,-4) {\Huge\bf Bob};
  \node[below = 1em of bob] (bobkey) {\Huge \rouge{$\key$}};
      \onslide<4,5,6>{
    \node[below = 1em of bobkey] (msgbob){\Huge if $Verif( \rouge{ \key}, N,\ver{C}, \ver{T})$ }; 
     \node[below right = 0.5em and -17em of msgbob] (msgbob2){\Huge return $\rouge{M} = Dec( \rouge{ \key}, N, \ver{C})$ }; 
  }

  % Eve
  \node (label) at (15,-6) {\includegraphics[height=7cm]{figures/canal_eve_dep.png}};
  \node (label) at (15,-10) {\Huge\bf Eve};
  \draw[<-, line width=1mm] (12,-7) -- ++(-3,0) -- node[left,align=center] {\Huge\bf Listen \\ \huge (Confidentiality)} ++(0,+5);
  \draw[->, line width=1mm] (18,-7) -- ++(+3,0) --  node[right,align=center] {\Huge\bf Modify \\ \huge (Integrity) } ++(0,+5);


  % Canal
  \draw[line width=1mm] (4,-1) ellipse (0.7 and 1);
  \draw[line width=1mm] (25,-2) arc (-90:90:1);

  \draw[line width=1mm] (4,0) -- ++(21,0);
  \draw[line width=1mm] (4,-2) -- ++(21,0);
  \node (channel) at (14.5, 1) {\Huge\bf Unreliable channel of communication};
  \onslide<3,4,5,6>{
    \node[below = 3em of channel] {\Huge $\rightarrow$ $(N,\ver{C},\ver{T})$ \color{black} $\rightarrow$};
  } 
    
\end{tikzpicture}

